component:
  name: api_gateway_deployment
  mapping:
    - .
  dependsOn:
    - ../api_gateway_rest_api
  template:
    resource:
      aws_api_gateway_deployment:
        api_gateway_deployment:
          rest_api_id: '${data.aws_api_gateway_rest_api.api_gateway_deployment.id}'
          stage_name: demo
          description: Managed by TerraHub
          stage_description: >-
            ${format("%s %s", var.api_gateway_deployment_stage_name,
            timestamp())}
    variable:
      api_gateway_deployment_stage_name:
        type: string
    output:
      id:
        value: '${aws_api_gateway_deployment.api_gateway_deployment.id}'
      thub_id:
        value: '${aws_api_gateway_deployment.api_gateway_deployment.id}'
      invoke_url:
        value: '${aws_api_gateway_deployment.api_gateway_deployment.invoke_url}'
      execution_arn:
        value: '${aws_api_gateway_deployment.api_gateway_deployment.execution_arn}'
      created_date:
        value: '${aws_api_gateway_deployment.api_gateway_deployment.created_date}'
    terraform:
      backend:
        s3:
          bucket: data-lake-terrahub-us-east-1
          key: terraform/mitocgroup/demo-terraform-automation-aws/api_gateway_deployment/terraform.tfstate
          region: us-east-1
          workspace_key_prefix: terraform_workspaces
    data:
      aws_api_gateway_rest_api:
        api_gateway_deployment:
          name: DemoApi7356626c
    tfvars:
      api_gateway_deployment_stage_name: Deployed at
